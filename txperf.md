# tx perf notes

POST to API endpoint /txPerf with query string params

	* d	: duration, overall duration of text (in time.Duration format, e.g. 30s for 30 seconds)
	* n : number of concurrent requests

## v1

concurrent calls to concatTx where none of the keys overal, all tx's commit.

concatTx parallelizes the initial key reads, and then the check loops.

api -> view comms is protobuf / grpc over tcp

run from Simon's laptop (4 partitions, 400k keys totals)

    $ curl -X POST "http://localhost:9988/txPerf?d=30s&n=10"
	
	      n |  Count | Commits | Aborts | Errors |        p25 |        p50 |        p90 |        p99 |
	 ------ | ------ | ------- | ------ | ------ | ---------- | ---------- | ---------- | ---------- |
	      0 |  10990 |   10990 |      0 |      0 | 2.253935ms | 2.554299ms | 3.639982ms | 6.119479ms |
	      1 |  11014 |   11014 |      0 |      0 | 2.250916ms | 2.546791ms | 3.651579ms | 6.073584ms |
	      2 |  10981 |   10981 |      0 |      0 | 2.252267ms | 2.555561ms | 3.656002ms | 6.111583ms |
	      3 |  11003 |   11003 |      0 |      0 | 2.253491ms | 2.550875ms | 3.637321ms | 5.910028ms |
	      4 |  10995 |   10995 |      0 |      0 | 2.255674ms | 2.552709ms |  3.63766ms | 6.123404ms |
	      5 |  10988 |   10988 |      0 |      0 | 2.249159ms | 2.554981ms | 3.637495ms | 5.980126ms |
	      6 |  11020 |   11020 |      0 |      0 | 2.247871ms |  2.54717ms | 3.641092ms | 6.070027ms |
	      7 |  10996 |   10996 |      0 |      0 | 2.248666ms | 2.551715ms | 3.655723ms | 6.184265ms |
	      8 |  10992 |   10992 |      0 |      0 |  2.25068ms | 2.547986ms | 3.672467ms | 6.263325ms |
	      9 |  11010 |   11010 |      0 |      0 | 2.255957ms | 2.551157ms | 3.640059ms | 6.053899ms |
	 ------ | ------ | ------- | ------ | ------ | ---------- | ---------- | ---------- | ---------- |
	 Totals | 109989 |  109989 |      0 |      0 | 2.251869ms | 2.551434ms | 3.647378ms | 6.076723ms |

runs from the (CPU starved) test cluster (4 partitions, 31M keys total)

	$ curl -X POST 'http://10.64.222.170:9988/txPerf?n=3&d=30s'
	      n | Count | Commits | Aborts | Errors |        p25 |        p50 |        p90 |        p99 |
	 ------ | ----- | ------- | ------ | ------ | ---------- | ---------- | ---------- | ---------- |
	      0 |  6995 |    6995 |      0 |      0 | 3.554326ms | 4.082147ms | 5.384104ms | 6.664023ms |
	      1 |  7003 |    7003 |      0 |      0 | 3.561739ms | 4.075915ms | 5.380644ms | 6.557643ms |
	      2 |  7004 |    7004 |      0 |      0 | 3.558788ms | 4.071994ms | 5.406553ms | 6.733389ms |
	 ------ | ----- | ------- | ------ | ------ | ---------- | ---------- | ---------- | ---------- |
	 Totals | 21002 |   21002 |      0 |      0 | 3.558455ms | 4.077201ms | 5.388839ms | 6.661278ms |
 
 
	$ curl -X POST 'http://10.64.222.170:9988/txPerf?n=10&d=30s'
    
	      n | Count | Commits | Aborts | Errors |        p25 |        p50 |        p90 |        p99 |
	 ------ | ----- | ------- | ------ | ------ | ---------- | ---------- | ---------- | ---------- |
	      0 |  5777 |    5777 |      0 |      0 | 4.509207ms | 4.963015ms |  6.52851ms | 8.306778ms |
	      1 |  5791 |    5791 |      0 |      0 | 4.491836ms | 4.965223ms | 6.498762ms | 8.511929ms |
	      2 |  5771 |    5771 |      0 |      0 | 4.513638ms |  4.97315ms | 6.497887ms | 8.488345ms |
	      3 |  5775 |    5775 |      0 |      0 | 4.523596ms | 4.989114ms | 6.497103ms | 8.358485ms |
	      4 |  5777 |    5777 |      0 |      0 | 4.501807ms |  4.97173ms | 6.514702ms | 8.492129ms |
	      5 |  5785 |    5785 |      0 |      0 | 4.491995ms | 4.974467ms | 6.531997ms | 8.405366ms |
	      6 |  5782 |    5782 |      0 |      0 | 4.504235ms | 4.959183ms | 6.511351ms | 8.419784ms |
	      7 |  5777 |    5777 |      0 |      0 | 4.507084ms | 4.985259ms | 6.522974ms | 8.452545ms |
	      8 |  5791 |    5791 |      0 |      0 | 4.509555ms | 4.970714ms | 6.469521ms | 8.403863ms |
	      9 |  5796 |    5796 |      0 |      0 | 4.501561ms | 4.974182ms | 6.454848ms | 8.268034ms |
	 ------ | ----- | ------- | ------ | ------ | ---------- | ---------- | ---------- | ---------- |
	 Totals | 57822 |   57822 |      0 |      0 | 4.504781ms |  4.97239ms | 6.503651ms |    8.406ms |

 
	$ curl -X POST 'http://10.64.222.170:9988/txPerf?n=40&d=30s'
	      n | Count | Commits | Aborts | Errors |         p25 |         p50 |         p90 |         p99 |
	 ------ | ----- | ------- | ------ | ------ | ----------- | ----------- | ----------- | ----------- |
	      0 |  2318 |    2318 |      0 |      0 |  11.17628ms | 12.500508ms |  15.89114ms | 21.428286ms |
	      1 |  2325 |    2325 |      0 |      0 | 11.197525ms | 12.509977ms | 15.894769ms | 20.397429ms |
	      2 |  2325 |    2325 |      0 |      0 | 11.209184ms | 12.477759ms | 15.684045ms | 21.130596ms |
	      3 |  2324 |    2324 |      0 |      0 | 11.256309ms | 12.535973ms | 15.694393ms | 20.706044ms |
	      4 |  2324 |    2324 |      0 |      0 | 11.150897ms | 12.525118ms | 15.725756ms | 20.685507ms |
	      5 |  2334 |    2334 |      0 |      0 | 11.084538ms | 12.428186ms |  15.87435ms | 19.905065ms |
	      6 |  2325 |    2325 |      0 |      0 | 11.163279ms | 12.507059ms |  15.80317ms | 19.851712ms |
	      7 |  2326 |    2326 |      0 |      0 |   11.1649ms | 12.538952ms | 15.778604ms | 20.853635ms |
	      8 |  2321 |    2321 |      0 |      0 | 11.163608ms | 12.509325ms | 15.858683ms | 21.143862ms |
	      9 |  2334 |    2334 |      0 |      0 | 11.148344ms | 12.473134ms | 15.779681ms | 19.993648ms |
	     10 |  2318 |    2318 |      0 |      0 | 11.194535ms | 12.503445ms | 15.855583ms |  20.41732ms |
	     11 |  2330 |    2330 |      0 |      0 | 11.141662ms | 12.515018ms | 15.808422ms |  20.69098ms |
	     12 |  2322 |    2322 |      0 |      0 | 11.199372ms | 12.566138ms | 15.780939ms | 20.417281ms |
	     13 |  2322 |    2322 |      0 |      0 | 11.211598ms | 12.502233ms | 15.698635ms |   20.7874ms |
	     14 |  2319 |    2319 |      0 |      0 | 11.204192ms | 12.528053ms | 15.882128ms | 20.594146ms |
	     15 |  2325 |    2325 |      0 |      0 |  11.17287ms | 12.488243ms | 15.849192ms | 20.577152ms |
	     16 |  2332 |    2332 |      0 |      0 | 11.125706ms | 12.446572ms | 15.753166ms | 19.953319ms |
	     17 |  2324 |    2324 |      0 |      0 | 11.200267ms | 12.512882ms | 15.792548ms | 20.362125ms |
	     18 |  2316 |    2316 |      0 |      0 | 11.238531ms | 12.552068ms | 15.760253ms | 21.460571ms |
	     19 |  2324 |    2324 |      0 |      0 | 11.205079ms | 12.474037ms | 15.775946ms |  20.79408ms |
	     20 |  2324 |    2324 |      0 |      0 | 11.166074ms | 12.530559ms | 15.826788ms | 19.871967ms |
	     21 |  2326 |    2326 |      0 |      0 | 11.178013ms | 12.483364ms |  15.90029ms |   20.5644ms |
	     22 |  2332 |    2332 |      0 |      0 | 11.203371ms | 12.434104ms | 15.714305ms | 20.080427ms |
	     23 |  2345 |    2345 |      0 |      0 | 11.111842ms |  12.41071ms | 15.641144ms | 20.007836ms |
	     24 |  2334 |    2334 |      0 |      0 | 11.092434ms | 12.445298ms | 15.842365ms | 20.003472ms |
	     25 |  2334 |    2334 |      0 |      0 | 11.204715ms | 12.408803ms | 15.836841ms | 19.611814ms |
	     26 |  2326 |    2326 |      0 |      0 | 11.146209ms | 12.429335ms | 15.813771ms | 20.599513ms |
	     27 |  2325 |    2325 |      0 |      0 | 11.186994ms | 12.456092ms | 15.909355ms | 20.909692ms |
	     28 |  2337 |    2337 |      0 |      0 | 11.157282ms | 12.406594ms | 15.836925ms | 20.336623ms |
	     29 |  2326 |    2326 |      0 |      0 | 11.207189ms | 12.462755ms | 15.801597ms |  20.33177ms |
	     30 |  2332 |    2332 |      0 |      0 | 11.114939ms | 12.484546ms | 15.786029ms | 20.409474ms |
	     31 |  2329 |    2329 |      0 |      0 | 11.211367ms |  12.50484ms | 15.688294ms | 20.302741ms |
	     32 |  2333 |    2333 |      0 |      0 |  11.18132ms | 12.452621ms | 15.829877ms | 20.037309ms |
	     33 |  2320 |    2320 |      0 |      0 | 11.192314ms | 12.542309ms | 15.814251ms | 20.470232ms |
	     34 |  2318 |    2318 |      0 |      0 |  11.22729ms | 12.485641ms | 15.900739ms | 20.298362ms |
	     35 |  2325 |    2325 |      0 |      0 | 11.241176ms | 12.480455ms | 15.756833ms | 20.875358ms |
	     36 |  2316 |    2316 |      0 |      0 | 11.292909ms | 12.467519ms | 15.714382ms | 20.786038ms |
	     37 |  2332 |    2332 |      0 |      0 | 11.115004ms | 12.484176ms | 15.875266ms | 20.998886ms |
	     38 |  2325 |    2325 |      0 |      0 |  11.24333ms | 12.517982ms | 15.697135ms | 20.505965ms |
	     39 |  2326 |    2326 |      0 |      0 | 11.138517ms | 12.502676ms | 15.752554ms | 20.110293ms |
	 ------ | ----- | ------- | ------ | ------ | ----------- | ----------- | ----------- | ----------- |
	 Totals | 93053 |   93053 |      0 |      0 | 11.181139ms | 12.486816ms | 15.795613ms | 20.549634ms |

# v1.01

No changes to impl, but captures metrics from the api server for both the grpc client calls and the parts of the concat operation, as well as some metrics from inside the kv view.

	$ curl  "http://10.64.222.170:9988/txPerf?n=10&d=30s" -X POST
	      n | Count | Commits | Aborts | Errors |        p25 |        p50 |        p90 |         p99 |
	 ------ | ----- | ------- | ------ | ------ | ---------- | ---------- | ---------- | ----------- |
	      0 |  4961 |    4961 |      0 |      0 | 4.809655ms | 5.485441ms | 8.378652ms | 12.971814ms |
	      1 |  4974 |    4974 |      0 |      0 | 4.810746ms | 5.474865ms | 8.449235ms | 13.122429ms |
	      2 |  4982 |    4982 |      0 |      0 | 4.801694ms | 5.458786ms | 8.392891ms | 13.381601ms |
	      3 |  4986 |    4986 |      0 |      0 | 4.791393ms | 5.478984ms | 8.259431ms | 13.468093ms |
	      4 |  4970 |    4970 |      0 |      0 | 4.800848ms | 5.495659ms | 8.377296ms | 13.643719ms |
	      5 |  4964 |    4964 |      0 |      0 | 4.787477ms | 5.481011ms | 8.451777ms | 13.171411ms |
	      6 |  4966 |    4966 |      0 |      0 |  4.81275ms | 5.495872ms | 8.412181ms | 13.006833ms |
	      7 |  4952 |    4952 |      0 |      0 | 4.814819ms |  5.49151ms | 8.490529ms | 12.819818ms |
	      8 |  4968 |    4968 |      0 |      0 | 4.818379ms | 5.483009ms | 8.387734ms | 13.576759ms |
	      9 |  4975 |    4975 |      0 |      0 | 4.812989ms | 5.505998ms | 8.341296ms | 13.183901ms |
	 ------ | ----- | ------- | ------ | ------ | ---------- | ---------- | ---------- | ----------- |
	 Totals | 49698 |   49698 |      0 |      0 | 4.805451ms | 5.485339ms | 8.398372ms | 13.170964ms |


	              Name |  Count |       Mean |        Min |        p50 |        p90 |        p99 |       p99.9 |         Max |
	 ----------------- | ------ | ---------- | ---------- | ---------- | ---------- | ---------- | ----------- | ----------- |
	  api.concat.check |  49698 | 1.470354ms | 0.380011ms | 0.908798ms | 3.162446ms | 6.042220ms | 19.391853ms | 19.603766ms |
	 api.concat.decide |  49698 | 1.725908ms | 0.697299ms | 1.612008ms | 2.263410ms | 4.930522ms |  8.522582ms |  8.530365ms |
	  api.concat.fetch |  49698 | 1.006237ms | 0.388744ms | 0.823585ms | 1.695089ms | 2.905550ms |  8.197462ms |  8.320637ms |
	  api.concat.write |  49698 | 1.743577ms | 0.665576ms | 1.625817ms | 2.199311ms | 3.617220ms | 23.207951ms | 23.230551ms |
	      client.check | 111626 | 0.797253ms | 0.264890ms | 0.611562ms | 1.373031ms | 2.952623ms |  9.045181ms |  9.065999ms |
	      client.fetch |  99396 | 0.787867ms | 0.262789ms | 0.580670ms | 1.263623ms | 3.096877ms | 12.607300ms | 12.628862ms |
	 client.sampleKeys |      1 | 1.751207ms | 1.751207ms | 1.751207ms | 1.751207ms | 1.751207ms |  1.751207ms |  1.751207ms |

	Partition Metrics: 0
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1102147 | 0.020455ms | 0.000000ms | 0.009775ms | 0.041715ms | 0.115673ms | 1.617969ms | 1.635003ms |
	 partition.apply.lock.wait | 1102147 | 0.000929ms | 0.000000ms | 0.000622ms | 0.000709ms | 0.012535ms | 0.072397ms | 0.072832ms |
	     partition.check.check |   31615 | 0.001591ms | 0.000000ms | 0.001211ms | 0.001387ms | 0.006846ms | 0.219848ms | 0.225342ms |
	 partition.check.lock.wait |   31615 | 0.000912ms | 0.000000ms | 0.000675ms | 0.000780ms | 0.006340ms | 0.116106ms | 0.119036ms |

	Partition Metrics: 1
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1103318 | 0.025015ms | 0.000000ms | 0.010776ms | 0.045788ms | 0.145276ms | 3.677897ms | 3.747955ms |
	 partition.apply.lock.wait | 1103318 | 0.000721ms | 0.000000ms | 0.000624ms | 0.000718ms | 0.001531ms | 0.021347ms | 0.021377ms |
	     partition.check.check |   28118 | 0.002077ms | 0.000437ms | 0.001205ms | 0.001463ms | 0.016053ms | 0.308868ms | 0.314916ms |
	 partition.check.lock.wait |   28118 | 0.001264ms | 0.000000ms | 0.000649ms | 0.000765ms | 0.013145ms | 0.241386ms | 0.244760ms |

	Partition Metrics: 2
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1105969 | 0.021375ms | 0.000000ms | 0.011423ms | 0.049966ms | 0.129660ms | 0.582883ms | 0.592652ms |
	 partition.apply.lock.wait | 1105969 | 0.000692ms | 0.000000ms | 0.000651ms | 0.000722ms | 0.001409ms | 0.013829ms | 0.013833ms |
	     partition.check.check |   28890 | 0.001564ms | 0.000000ms | 0.001275ms | 0.001594ms | 0.010347ms | 0.129536ms | 0.132689ms |
	 partition.check.lock.wait |   28890 | 0.000757ms | 0.000000ms | 0.000672ms | 0.000779ms | 0.001788ms | 0.016485ms | 0.016581ms |

	Partition Metrics: 3
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1100987 | 0.020549ms | 0.000000ms | 0.010595ms | 0.045163ms | 0.152168ms | 1.204626ms | 1.233291ms |
	 partition.apply.lock.wait | 1100987 | 0.000750ms | 0.000000ms | 0.000600ms | 0.000709ms | 0.007111ms | 0.021857ms | 0.021860ms |
	     partition.check.check |   31488 | 0.001487ms | 0.000000ms | 0.001228ms | 0.001573ms | 0.010956ms | 0.066043ms | 0.066196ms |
	 partition.check.lock.wait |   31488 | 0.000766ms | 0.000000ms | 0.000632ms | 0.000743ms | 0.001228ms | 0.064712ms | 0.066040ms |

# v1.02

Tweaks to check, in the kv impl, have it walk the versions backwards, the offending version is likely to be at the end of the list, not the start.
have the check look in concat wait less before retrying.

	$ curl  "http://10.64.222.170:9988/txPerf?n=10&d=30s" -X POST
	      n | Count | Commits | Aborts | Errors |        p25 |        p50 |        p90 |        p99 |
	 ------ | ----- | ------- | ------ | ------ | ---------- | ---------- | ---------- | ---------- |
	      0 |  5628 |    5628 |      0 |      0 | 4.599979ms | 5.088858ms | 6.633328ms | 8.935111ms |
	      1 |  5631 |    5631 |      0 |      0 | 4.589469ms | 5.086779ms | 6.630413ms | 8.807186ms |
	      2 |  5635 |    5635 |      0 |      0 | 4.611619ms |  5.08098ms |   6.6329ms | 8.737509ms |
	      3 |  5611 |    5611 |      0 |      0 | 4.614382ms | 5.090497ms | 6.662584ms | 8.833294ms |
	      4 |  5615 |    5615 |      0 |      0 | 4.608587ms | 5.098021ms | 6.663747ms | 8.858118ms |
	      5 |  5623 |    5623 |      0 |      0 | 4.588782ms |  5.09512ms | 6.627085ms | 8.945483ms |
	      6 |  5623 |    5623 |      0 |      0 |  4.59583ms | 5.089383ms | 6.644991ms | 8.947146ms |
	      7 |  5606 |    5606 |      0 |      0 |  4.60967ms | 5.105481ms | 6.680043ms | 8.966773ms |
	      8 |  5625 |    5625 |      0 |      0 | 4.597361ms | 5.092368ms | 6.659449ms | 8.737319ms |
	      9 |  5605 |    5605 |      0 |      0 | 4.615734ms | 5.097796ms | 6.721244ms | 8.831712ms |
	 ------ | ----- | ------- | ------ | ------ | ---------- | ---------- | ---------- | ---------- |
	 Totals | 56202 |   56202 |      0 |      0 | 4.603664ms | 5.092985ms | 6.651913ms | 8.865496ms |


	              Name |  Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ----------------- | ------ | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	  api.concat.check |  56202 | 1.104697ms | 0.417506ms | 0.883208ms | 1.907412ms | 3.668599ms | 5.526335ms | 5.554344ms |
	 api.concat.decide |  56202 | 1.625667ms | 0.589677ms | 1.584965ms | 2.119813ms | 2.849538ms | 8.553327ms | 8.706096ms |
	  api.concat.fetch |  56202 | 0.932893ms | 0.379035ms | 0.794344ms | 1.447190ms | 2.636699ms | 9.588321ms | 9.747944ms |
	  api.concat.write |  56202 | 1.616124ms | 0.611586ms | 1.570216ms | 2.091197ms | 2.963411ms | 5.138829ms | 5.163894ms |
	      client.check | 121767 | 0.686931ms | 0.278407ms | 0.563899ms | 1.110361ms | 2.433389ms | 4.613836ms | 4.635416ms |
	      client.fetch | 112404 | 0.665092ms | 0.258910ms | 0.550350ms | 1.095856ms | 2.041845ms | 2.808676ms | 2.809680ms |
	 client.sampleKeys |      1 | 1.839255ms | 1.839255ms | 1.839255ms | 1.839255ms | 1.839255ms | 1.839255ms | 1.839255ms |

	Partition Metrics: 0
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1131047 | 0.017102ms | 0.000000ms | 0.009844ms | 0.039239ms | 0.111062ms | 0.251008ms | 0.254141ms |
	 partition.apply.lock.wait | 1131047 | 0.000826ms | 0.000000ms | 0.000646ms | 0.000737ms | 0.011229ms | 0.027837ms | 0.028036ms |
	     partition.check.check |   66453 | 0.001531ms | 0.000000ms | 0.001253ms | 0.001476ms | 0.013267ms | 0.075279ms | 0.075770ms |
	 partition.check.lock.wait |   66453 | 0.000949ms | 0.000000ms | 0.000667ms | 0.000761ms | 0.002210ms | 0.162510ms | 0.166714ms |

	Partition Metrics: 1
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1133313 | 0.016739ms | 0.000000ms | 0.009370ms | 0.035463ms | 0.116262ms | 0.235484ms | 0.236528ms |
	 partition.apply.lock.wait | 1133313 | 0.000846ms | 0.000000ms | 0.000620ms | 0.000724ms | 0.013206ms | 0.033130ms | 0.033242ms |
	     partition.check.check |   64981 | 0.001449ms | 0.000000ms | 0.001203ms | 0.001509ms | 0.012498ms | 0.035856ms | 0.035900ms |
	 partition.check.lock.wait |   64981 | 0.000808ms | 0.000000ms | 0.000645ms | 0.000749ms | 0.001648ms | 0.059835ms | 0.061045ms |

	Partition Metrics: 2
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1130383 | 0.018500ms | 0.002514ms | 0.009626ms | 0.045050ms | 0.117658ms | 0.290730ms | 0.293167ms |
	 partition.apply.lock.wait | 1130383 | 0.000908ms | 0.000000ms | 0.000637ms | 0.000728ms | 0.012835ms | 0.088499ms | 0.089517ms |
	     partition.check.check |   62321 | 0.001774ms | 0.000000ms | 0.001252ms | 0.001483ms | 0.014734ms | 0.183033ms | 0.184741ms |
	 partition.check.lock.wait |   62321 | 0.000845ms | 0.000000ms | 0.000665ms | 0.000757ms | 0.001280ms | 0.112499ms | 0.114978ms |

	Partition Metrics: 3
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1132241 | 0.020451ms | 0.002511ms | 0.009421ms | 0.040497ms | 0.127132ms | 2.737483ms | 2.813427ms |
	 partition.apply.lock.wait | 1132241 | 0.000793ms | 0.000000ms | 0.000575ms | 0.000653ms | 0.005307ms | 0.077270ms | 0.078783ms |
	     partition.check.check |   62005 | 0.001304ms | 0.000000ms | 0.001141ms | 0.001380ms | 0.011554ms | 0.018203ms | 0.018214ms |
	 partition.check.lock.wait |   62005 | 0.000934ms | 0.000000ms | 0.000630ms | 0.000733ms | 0.007402ms | 0.106494ms | 0.107700ms |
	 
# v1.03

Added a option for check to block in the view until its not pending. 

 * Initial dumb impl just does the sleep / check wait inside the view.
 * Smarter impl uses a sync.Cond to wake up the check after each chunk of apply work.
 
Neither version gives much of a change.


	$ curl -X POST "http://10.64.222.170:9988/txPerf?d=60s&n=3"
	      n | Count | Commits | Aborts | Errors |        p25 |        p50 |        p90 |        p99 |
	 ------ | ----- | ------- | ------ | ------ | ---------- | ---------- | ---------- | ---------- |
	      0 | 14747 |   14747 |      0 |      0 | 3.391776ms | 3.727079ms | 5.352612ms | 8.625193ms |
	      1 | 14731 |   14731 |      0 |      0 | 3.390169ms | 3.726728ms | 5.349802ms | 8.635738ms |
	      2 | 14751 |   14751 |      0 |      0 | 3.390004ms | 3.722725ms | 5.392017ms | 8.426348ms |
	 ------ | ----- | ------- | ------ | ------ | ---------- | ---------- | ---------- | ---------- |
	 Totals | 44229 |   44229 |      0 |      0 | 3.390695ms | 3.726037ms | 5.362059ms | 8.534846ms |


	              Name | Count |       Mean |        Min |        p50 |        p90 |        p99 |       p99.9 |         Max |
	 ----------------- | ----- | ---------- | ---------- | ---------- | ---------- | ---------- | ----------- | ----------- |
	  api.concat.check | 44229 | 1.014084ms | 0.376583ms | 0.726132ms | 2.057104ms | 3.824676ms |  7.600509ms |  7.619836ms |
	 api.concat.decide | 44229 | 1.145219ms | 0.415889ms | 1.098689ms | 1.560636ms | 2.266988ms |  4.370164ms |  4.387772ms |
	  api.concat.fetch | 44229 | 0.830572ms | 0.384618ms | 0.642158ms | 1.167054ms | 3.138548ms | 52.743383ms | 54.049592ms |
	  api.concat.write | 44229 | 1.144044ms | 0.401470ms | 1.115530ms | 1.534100ms | 2.178342ms |  3.831379ms |  3.831433ms |
	      client.check | 88458 | 0.778326ms | 0.294365ms | 0.512019ms | 1.327435ms | 3.490206ms | 25.247521ms | 25.483624ms |
	      client.fetch | 88458 | 0.582961ms | 0.292372ms | 0.473662ms | 0.810487ms | 2.215550ms |  6.816244ms |  6.831497ms |
	 client.sampleKeys |     1 | 1.655329ms | 1.655329ms | 1.655329ms | 1.655329ms | 1.655329ms |  1.655329ms |  1.655329ms |

	Partition Metrics: 0
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1238940 | 0.007000ms | 0.000000ms | 0.005464ms | 0.011506ms | 0.028262ms | 0.050338ms | 0.050546ms |
	 partition.apply.lock.wait | 1238940 | 0.001143ms | 0.000000ms | 0.000719ms | 0.000867ms | 0.010700ms | 0.121096ms | 0.121657ms |
	     partition.check.check |   67717 | 0.154809ms | 0.000000ms | 0.005476ms | 0.278023ms | 2.383511ms | 9.088801ms | 9.237172ms |
	 partition.check.lock.wait |   67717 | 0.000760ms | 0.000000ms | 0.000675ms | 0.000745ms | 0.001868ms | 0.021871ms | 0.022033ms |

	Partition Metrics: 1
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1236486 | 0.006365ms | 0.000000ms | 0.005110ms | 0.008641ms | 0.027680ms | 0.048566ms | 0.048615ms |
	 partition.apply.lock.wait | 1236486 | 0.000881ms | 0.000000ms | 0.000665ms | 0.000796ms | 0.013389ms | 0.031380ms | 0.031545ms |
	     partition.check.check |   67710 | 0.105391ms | 0.003423ms | 0.005125ms | 0.167782ms | 1.925219ms | 3.691454ms | 3.728858ms |
	 partition.check.lock.wait |   67710 | 0.000722ms | 0.000000ms | 0.000615ms | 0.000680ms | 0.001278ms | 0.033147ms | 0.033256ms |

	Partition Metrics: 2
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1233441 | 0.006320ms | 0.000000ms | 0.005207ms | 0.009084ms | 0.023574ms | 0.043147ms | 0.043476ms |
	 partition.apply.lock.wait | 1233441 | 0.000750ms | 0.000000ms | 0.000667ms | 0.000789ms | 0.001856ms | 0.013748ms | 0.013751ms |
	     partition.check.check |   63724 | 0.224418ms | 0.003303ms | 0.005877ms | 0.662536ms | 2.195801ms | 6.640436ms | 6.761712ms |
	 partition.check.lock.wait |   63724 | 0.000707ms | 0.000000ms | 0.000623ms | 0.000677ms | 0.001553ms | 0.019679ms | 0.019822ms |

	Partition Metrics: 3
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1236670 | 0.006410ms | 0.002747ms | 0.005202ms | 0.009145ms | 0.026998ms | 0.046671ms | 0.046814ms |
	 partition.apply.lock.wait | 1236670 | 0.000756ms | 0.000000ms | 0.000626ms | 0.000773ms | 0.001415ms | 0.040520ms | 0.041168ms |
	     partition.check.check |   63731 | 0.159559ms | 0.001808ms | 0.005469ms | 0.454394ms | 1.855363ms | 2.848578ms | 2.859215ms |
	 partition.check.lock.wait |   63731 | 0.000670ms | 0.000000ms | 0.000593ms | 0.000683ms | 0.001342ms | 0.018605ms | 0.018756ms |





	$ curl -X POST "http://10.64.222.170:9988/txPerf?d=60s&n=15"
	      n |  Count | Commits | Aborts | Errors |        p25 |        p50 |        p90 |         p99 |
	 ------ | ------ | ------- | ------ | ------ | ---------- | ---------- | ---------- | ----------- |
	      0 |   8910 |    8910 |      0 |      0 | 5.712368ms | 6.406078ms | 8.503665ms | 12.201385ms |
	      1 |   8918 |    8918 |      0 |      0 | 5.709888ms |  6.39939ms | 8.523858ms | 12.246775ms |
	      2 |   8953 |    8953 |      0 |      0 | 5.709507ms | 6.364062ms | 8.469179ms | 11.900601ms |
	      3 |   8919 |    8919 |      0 |      0 | 5.721226ms | 6.391532ms |  8.57488ms | 12.026836ms |
	      4 |   8923 |    8923 |      0 |      0 | 5.715509ms | 6.404205ms | 8.473531ms | 11.967096ms |
	      5 |   8956 |    8956 |      0 |      0 |  5.70678ms | 6.374825ms |  8.48599ms |  11.64166ms |
	      6 |   8950 |    8950 |      0 |      0 | 5.720244ms |  6.39069ms | 8.471592ms | 11.952877ms |
	      7 |   8970 |    8970 |      0 |      0 | 5.689735ms | 6.372765ms | 8.452847ms | 11.893905ms |
	      8 |   8953 |    8953 |      0 |      0 | 5.710604ms | 6.378317ms | 8.476338ms | 11.829557ms |
	      9 |   8937 |    8937 |      0 |      0 | 5.714847ms | 6.384706ms | 8.512224ms |  11.84398ms |
	     10 |   8935 |    8935 |      0 |      0 | 5.704805ms | 6.392285ms | 8.549206ms | 11.995865ms |
	     11 |   8936 |    8936 |      0 |      0 | 5.710687ms |   6.4056ms | 8.501429ms | 11.868835ms |
	     12 |   8941 |    8941 |      0 |      0 | 5.700601ms | 6.390313ms | 8.502107ms | 11.928811ms |
	     13 |   8933 |    8933 |      0 |      0 | 5.711365ms |  6.38625ms | 8.536469ms | 11.996806ms |
	     14 |   8941 |    8941 |      0 |      0 | 5.715952ms | 6.384882ms |  8.44993ms | 12.041788ms |
	 ------ | ------ | ------- | ------ | ------ | ---------- | ---------- | ---------- | ----------- |
	 Totals | 134075 |  134075 |      0 |      0 |  5.71065ms | 6.388132ms | 8.498878ms | 11.957477ms |


	              Name |  Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ----------------- | ------ | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	  api.concat.check | 134075 | 1.329513ms | 0.414944ms | 1.055821ms | 2.234688ms | 4.840045ms | 9.357636ms | 9.393303ms |
	 api.concat.decide | 134075 | 2.037192ms | 0.853190ms | 1.941248ms | 2.657392ms | 4.495199ms | 8.117343ms | 8.127284ms |
	  api.concat.fetch | 134075 | 1.234396ms | 0.385621ms | 1.026945ms | 2.029238ms | 4.180084ms | 5.397249ms | 5.400846ms |
	  api.concat.write | 134075 | 2.008617ms | 0.588823ms | 1.942092ms | 2.610492ms | 4.603239ms | 7.178654ms | 7.185725ms |
	      client.check | 268150 | 0.978528ms | 0.255553ms | 0.784967ms | 1.720148ms | 3.894098ms | 7.137544ms | 7.173580ms |
	      client.fetch | 268150 | 0.992948ms | 0.272983ms | 0.755892ms | 1.833337ms | 4.747578ms | 7.172547ms | 7.175501ms |
	 client.sampleKeys |      1 | 4.215636ms | 4.215636ms | 4.215636ms | 4.215636ms | 4.215636ms | 4.215636ms | 4.215636ms |

	Partition Metrics: 0
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1278767 | 0.011123ms | 0.002491ms | 0.009277ms | 0.019803ms | 0.041132ms | 0.057726ms | 0.057798ms |
	 partition.apply.lock.wait | 1278767 | 0.000876ms | 0.000000ms | 0.000724ms | 0.000840ms | 0.009608ms | 0.013835ms | 0.013835ms |
	     partition.check.check |  136790 | 0.013903ms | 0.000000ms | 0.005177ms | 0.006846ms | 0.222822ms | 2.002332ms | 2.045418ms |
	 partition.check.lock.wait |  136790 | 0.000780ms | 0.000000ms | 0.000665ms | 0.000739ms | 0.001998ms | 0.019573ms | 0.019621ms |

	Partition Metrics: 1
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1276320 | 0.010528ms | 0.003448ms | 0.008674ms | 0.015717ms | 0.036878ms | 0.203898ms | 0.206457ms |
	 partition.apply.lock.wait | 1276320 | 0.000858ms | 0.000000ms | 0.000678ms | 0.000780ms | 0.001201ms | 0.062096ms | 0.063184ms |
	     partition.check.check |  136774 | 0.008760ms | 0.003382ms | 0.004896ms | 0.005721ms | 0.122881ms | 0.455813ms | 0.457446ms |
	 partition.check.lock.wait |  136774 | 0.000913ms | 0.000000ms | 0.000617ms | 0.000677ms | 0.005149ms | 0.105914ms | 0.108098ms |

	Partition Metrics: 2
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |       p99.9 |         Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ----------- | ----------- |
	      parition.apply.chunk | 1272692 | 0.011362ms | 0.003351ms | 0.009319ms | 0.019056ms | 0.039023ms |  0.364207ms |  0.371353ms |
	 partition.apply.lock.wait | 1272692 | 0.000773ms | 0.000000ms | 0.000677ms | 0.000773ms | 0.001306ms |  0.025034ms |  0.025299ms |
	     partition.check.check |  128726 | 0.077912ms | 0.003166ms | 0.004814ms | 0.043735ms | 0.895912ms | 39.496415ms | 40.555874ms |
	 partition.check.lock.wait |  128726 | 0.000843ms | 0.000000ms | 0.000609ms | 0.000671ms | 0.013466ms |  0.041783ms |  0.042336ms |

	Partition Metrics: 3
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1276042 | 0.011063ms | 0.003405ms | 0.008766ms | 0.019013ms | 0.043987ms | 0.241436ms | 0.245039ms |
	 partition.apply.lock.wait | 1276042 | 0.000806ms | 0.000000ms | 0.000642ms | 0.000784ms | 0.008562ms | 0.019988ms | 0.020081ms |
	     partition.check.check |  128742 | 0.033333ms | 0.002590ms | 0.004878ms | 0.028485ms | 0.592406ms | 2.557609ms | 2.566062ms |
	 partition.check.lock.wait |  128742 | 0.000746ms | 0.000000ms | 0.000580ms | 0.000641ms | 0.000957ms | 0.087952ms | 0.089864ms |



	$ curl -X POST "http://10.64.222.170:9988/txPerf?d=60s&n=50"
	      n |  Count | Commits | Aborts | Errors |         p25 |         p50 |         p90 |         p99 |
	 ------ | ------ | ------- | ------ | ------ | ----------- | ----------- | ----------- | ----------- |
	      0 |   3532 |    3532 |      0 |      0 | 14.707893ms | 16.501764ms | 21.248151ms |  27.13391ms |
	      1 |   3536 |    3536 |      0 |      0 | 14.583717ms |  16.52022ms | 21.411967ms | 27.321313ms |
	      2 |   3521 |    3521 |      0 |      0 | 14.617639ms | 16.576102ms |  21.42281ms | 27.921853ms |
	      3 |   3546 |    3546 |      0 |      0 | 14.566055ms | 16.550997ms | 21.314141ms | 27.011754ms |
	      4 |   3529 |    3529 |      0 |      0 | 14.637839ms | 16.481236ms | 21.429508ms | 27.309625ms |
	      5 |   3542 |    3542 |      0 |      0 | 14.536412ms | 16.525737ms | 21.371105ms | 27.132208ms |
	      6 |   3529 |    3529 |      0 |      0 | 14.543812ms |  16.57697ms | 21.408722ms |  27.36954ms |
	      7 |   3539 |    3539 |      0 |      0 | 14.571979ms | 16.545082ms | 21.271608ms |  27.66798ms |
	      8 |   3547 |    3547 |      0 |      0 | 14.542134ms | 16.495719ms | 21.265186ms | 27.068676ms |
	      9 |   3525 |    3525 |      0 |      0 | 14.644949ms | 16.529073ms | 21.455057ms | 27.361904ms |
	     10 |   3520 |    3520 |      0 |      0 | 14.644431ms |  16.55061ms | 21.475059ms | 27.469279ms |
	     11 |   3536 |    3536 |      0 |      0 | 14.568853ms | 16.546888ms |  21.42313ms | 27.524836ms |
	     12 |   3528 |    3528 |      0 |      0 | 14.582755ms | 16.560527ms | 21.398775ms | 27.495257ms |
	     13 |   3525 |    3525 |      0 |      0 | 14.595069ms | 16.504173ms | 21.554855ms | 28.174779ms |
	     14 |   3525 |    3525 |      0 |      0 | 14.571583ms | 16.503047ms | 21.542577ms | 27.625839ms |
	     15 |   3543 |    3543 |      0 |      0 | 14.571811ms | 16.536514ms | 21.324361ms | 27.607288ms |
	     16 |   3525 |    3525 |      0 |      0 | 14.688636ms | 16.549791ms | 21.467936ms | 27.756898ms |
	     17 |   3549 |    3549 |      0 |      0 | 14.561141ms | 16.417061ms | 21.260225ms | 27.747403ms |
	     18 |   3525 |    3525 |      0 |      0 | 14.652123ms | 16.517211ms | 21.560994ms | 27.569837ms |
	     19 |   3520 |    3520 |      0 |      0 | 14.596611ms | 16.564317ms | 21.616124ms | 27.600418ms |
	     20 |   3544 |    3544 |      0 |      0 | 14.647261ms | 16.442565ms |  21.44168ms | 27.853875ms |
	     21 |   3520 |    3520 |      0 |      0 | 14.603994ms |  16.54891ms | 21.665084ms | 27.257307ms |
	     22 |   3536 |    3536 |      0 |      0 | 14.642934ms | 16.515776ms | 21.517128ms |  27.20361ms |
	     23 |   3525 |    3525 |      0 |      0 | 14.572153ms |  16.54094ms | 21.469701ms | 27.713869ms |
	     24 |   3537 |    3537 |      0 |      0 | 14.623783ms | 16.485778ms | 21.375856ms | 27.695869ms |
	     25 |   3531 |    3531 |      0 |      0 | 14.588507ms |  16.50031ms | 21.498341ms | 27.729898ms |
	     26 |   3548 |    3548 |      0 |      0 | 14.609925ms | 16.483532ms | 21.137875ms | 27.167717ms |
	     27 |   3528 |    3528 |      0 |      0 |  14.63333ms | 16.497675ms | 21.406194ms | 27.061129ms |
	     28 |   3549 |    3549 |      0 |      0 | 14.525189ms |  16.42372ms | 21.275993ms | 27.420807ms |
	     29 |   3520 |    3520 |      0 |      0 | 14.699585ms | 16.588462ms | 21.486149ms | 27.248884ms |
	     30 |   3525 |    3525 |      0 |      0 | 14.543957ms | 16.584966ms | 21.646038ms | 27.862587ms |
	     31 |   3529 |    3529 |      0 |      0 | 14.590602ms | 16.505412ms | 21.409204ms | 27.711876ms |
	     32 |   3539 |    3539 |      0 |      0 | 14.560831ms | 16.477973ms | 21.493849ms | 27.437237ms |
	     33 |   3529 |    3529 |      0 |      0 | 14.657702ms | 16.554044ms | 21.465873ms | 28.155813ms |
	     34 |   3524 |    3524 |      0 |      0 | 14.671276ms | 16.556026ms | 21.405861ms | 27.192566ms |
	     35 |   3536 |    3536 |      0 |      0 | 14.568961ms | 16.468285ms | 21.403344ms | 27.266857ms |
	     36 |   3524 |    3524 |      0 |      0 | 14.628179ms | 16.530663ms | 21.630388ms | 28.076697ms |
	     37 |   3536 |    3536 |      0 |      0 | 14.635445ms |  16.46649ms | 21.455744ms | 27.460549ms |
	     38 |   3543 |    3543 |      0 |      0 | 14.516606ms | 16.419523ms |  21.62941ms | 27.214813ms |
	     39 |   3549 |    3549 |      0 |      0 |  14.55476ms | 16.443414ms | 21.441039ms | 27.106684ms |
	     40 |   3545 |    3545 |      0 |      0 | 14.607565ms | 16.487177ms | 21.235307ms | 27.413967ms |
	     41 |   3526 |    3526 |      0 |      0 | 14.653834ms | 16.487077ms | 21.565337ms | 28.054941ms |
	     42 |   3546 |    3546 |      0 |      0 | 14.609007ms | 16.464214ms | 21.239505ms | 27.049911ms |
	     43 |   3550 |    3550 |      0 |      0 |   14.5687ms | 16.413966ms | 21.375928ms | 27.263638ms |
	     44 |   3517 |    3517 |      0 |      0 | 14.678949ms |  16.58735ms | 21.528701ms |  27.40023ms |
	     45 |   3544 |    3544 |      0 |      0 |  14.58125ms | 16.461301ms |   21.2937ms | 27.824229ms |
	     46 |   3525 |    3525 |      0 |      0 | 14.647959ms | 16.549318ms |  21.51584ms | 27.687382ms |
	     47 |   3539 |    3539 |      0 |      0 | 14.553313ms |  16.51209ms | 21.323667ms | 27.115027ms |
	     48 |   3531 |    3531 |      0 |      0 | 14.604917ms | 16.522215ms | 21.442018ms |  27.71259ms |
	     49 |   3537 |    3537 |      0 |      0 | 14.635893ms | 16.484958ms | 21.451432ms | 27.864744ms |
	 ------ | ------ | ------- | ------ | ------ | ----------- | ----------- | ----------- | ----------- |
	 Totals | 176674 |  176674 |      0 |      0 | 14.601997ms |  16.50723ms | 21.434569ms | 27.485552ms |


	              Name |  Count |       Mean |        Min |        p50 |        p90 |         p99 |       p99.9 |         Max |
	 ----------------- | ------ | ---------- | ---------- | ---------- | ---------- | ----------- | ----------- | ----------- |
	  api.concat.check | 176674 | 2.649613ms | 0.434569ms | 1.721659ms | 6.009044ms | 10.244474ms | 14.309494ms | 14.340399ms |
	 api.concat.decide | 176674 | 5.803442ms | 1.104315ms | 5.817836ms | 7.761066ms | 10.128968ms | 24.389240ms | 24.486595ms |
	  api.concat.fetch | 176674 | 2.704869ms | 0.437154ms | 1.869684ms | 5.831031ms | 10.856758ms | 18.492372ms | 18.571901ms |
	  api.concat.write | 176674 | 5.763655ms | 1.624203ms | 5.803952ms | 7.660547ms |  9.839436ms | 15.913066ms | 16.008772ms |
	      client.check | 353348 | 2.057092ms | 0.289623ms | 1.397873ms | 4.793395ms |  8.801359ms | 11.477725ms | 11.526229ms |
	      client.fetch | 353348 | 2.005166ms | 0.270956ms | 1.308191ms | 4.561198ms |  8.684536ms | 12.638021ms | 12.686566ms |
	 client.sampleKeys |      1 | 3.099040ms | 3.099040ms | 3.099040ms | 3.099040ms |  3.099040ms |  3.099040ms |  3.099040ms |

	Partition Metrics: 0
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1298874 | 0.018957ms | 0.002491ms | 0.013330ms | 0.036943ms | 0.086159ms | 0.140436ms | 0.140472ms |
	 partition.apply.lock.wait | 1298874 | 0.001315ms | 0.000000ms | 0.000729ms | 0.000915ms | 0.012913ms | 0.139453ms | 0.140830ms |
	     partition.check.check |  227818 | 0.016640ms | 0.003109ms | 0.005161ms | 0.014657ms | 0.305219ms | 2.007832ms | 2.045418ms |
	 partition.check.lock.wait |  227818 | 0.000965ms | 0.000000ms | 0.000664ms | 0.000737ms | 0.014504ms | 0.053918ms | 0.054309ms |

	Partition Metrics: 1
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1296428 | 0.017809ms | 0.002826ms | 0.011956ms | 0.035384ms | 0.087603ms | 0.382174ms | 0.387931ms |
	 partition.apply.lock.wait | 1296428 | 0.001037ms | 0.000000ms | 0.000678ms | 0.000823ms | 0.006434ms | 0.079242ms | 0.079722ms |
	     partition.check.check |  227770 | 0.010807ms | 0.003244ms | 0.004822ms | 0.006018ms | 0.230726ms | 0.726199ms | 0.731887ms |
	 partition.check.lock.wait |  227770 | 0.000833ms | 0.000141ms | 0.000608ms | 0.000673ms | 0.004186ms | 0.116336ms | 0.118965ms |

	Partition Metrics: 2
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1292756 | 0.017928ms | 0.000000ms | 0.013147ms | 0.034559ms | 0.070696ms | 0.234014ms | 0.236000ms |
	 partition.apply.lock.wait | 1292756 | 0.001602ms | 0.000000ms | 0.000682ms | 0.000881ms | 0.024335ms | 0.270497ms | 0.276088ms |
	     partition.check.check |  214372 | 0.017052ms | 0.002696ms | 0.004765ms | 0.009691ms | 0.345333ms | 1.449535ms | 1.463289ms |
	 partition.check.lock.wait |  214372 | 0.001160ms | 0.000000ms | 0.000603ms | 0.000671ms | 0.009593ms | 0.176509ms | 0.178110ms |

	Partition Metrics: 3
	                      Name |   Count |       Mean |        Min |        p50 |        p90 |        p99 |      p99.9 |        Max |
	 ------------------------- | ------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- | ---------- |
	      parition.apply.chunk | 1296041 | 0.016593ms | 0.000000ms | 0.012318ms | 0.031429ms | 0.062249ms | 0.241617ms | 0.245039ms |
	 partition.apply.lock.wait | 1296041 | 0.000977ms | 0.000000ms | 0.000638ms | 0.000805ms | 0.013353ms | 0.087139ms | 0.088143ms |
	     partition.check.check |  214420 | 0.025353ms | 0.002762ms | 0.004850ms | 0.010638ms | 0.552242ms | 3.132915ms | 3.152684ms |
	 partition.check.lock.wait |  214420 | 0.001104ms | 0.000000ms | 0.000576ms | 0.000655ms | 0.001714ms | 0.166860ms | 0.167523ms |

